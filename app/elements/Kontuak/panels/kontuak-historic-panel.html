<dom-module id="kontuak-historic-panel">
    <style>
        table {
            width: 100%;
        }
        td.number {
            text-align: right;
        }
        td.date {
            text-align: center;
        }
        thead {
            background-color: #eee;
        }
        th {
            padding: 0.8em 1em;
        }
        td {
            padding: 0.8em 0.5em;
        }
        tbody tr:hover {
            background-color: #fafafa;
        }
    </style>

    <template>
        <iron-ajax
                auto
                url="http://127.0.0.1:8000/movements/history?limit=20"
                handle-as="json"
                on-response="handleResponse"
                debounce-duration="3000"></iron-ajax>
        <paper-material elevation="1">
            <h3>Historic</h3>
            <table>
                <thead>
                    <tr>
                        <th class="movement-date">Date</th>
                        <th class="movement-concept">Concept</th>
                        <th class="movement-amount">Amount</th>
                        <th class="movement-total">Total</th>
                    </tr>
                </thead>
                <tbody>
                <template is="dom-repeat" items="[[movements]]">
                    <tr>
                        <td class="movement-date date">{{item.date}}</td>
                        <td class="movement-concept">{{item.concept}}</td>
                        <td class="movement-amount number">
                            <span class="sign">{{sign(item.amount)}}</span>
                            <span class="absolute-amount">{{abs(item.amount)}}</span>
                            <span class="currency">€</span>
                        </td>
                        <td class="movement-total-amount number">{{item.totalAmount}}<span class="currency">€</span></td>
                    </tr>
                </template>
                </tbody>
            </table>
        </paper-material>
    </template>

    <script>
        (function() {
            Polymer({
                is: 'kontuak-historic-panel',
                properties: {
                    movements: {
                        type: Array
                    }
                },
                handleResponse: function(e, request) {
                    this.movements = request.response;
                },
                sign: function(amount) {
                    if (amount >= 0) {
                        return '+';
                    } else {
                        return '-';
                    }
                },
                abs: function(amount) {
                    return Math.abs(amount);
                }
            });
        })();
    </script>
</dom-module>